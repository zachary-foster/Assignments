---
title: "Homework 5"
author: "Zachary Foster"
date: "11/06/2014"
output: pdf_document
---

### Prepare input data

```{r}
larvae_count <- 0:12
sample_count <- c(173, 74, 27, 14, 9, 5, 4, 2, 0, 0, 1, 1, 1)
data <- rep(larvae_count, sample_count)
hist(data)
```

### Find the k that makes the following function equal to zero

```{r}
# Note that parameters besides k in the function below are supplied as option defaults.
#  The uniroot function that calls f will only change k over the given interval. 
f <- function(k, N = length(data), N0 = sum(data == 0), xbar = mean(data)) {
  log(N/N0) - k * log(1 + xbar/k)  
}
k_hat <- uniroot(f=f, interval=c(0.001, 100))$root
```

### Generate expected counts

```{r}
prob <- dnbinom(x = larvae_count, size = k_hat, prob = k_hat/(k_hat + mean(data)))
plot(prob)
```

